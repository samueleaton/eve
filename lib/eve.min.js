var Eve=function(){var e={},r={},n={add:function(r,n){var t={fn:n};return e[r]=e[r]||[],e[r].push(t),{evt:r,fn:n,ignore:function(){return Eve.ignore(this.evt)},remove:function(){return Eve.remove(this.evt,this.fn)},removeAll:function(){return Eve.removeAll(this.evt)},defer:function(){return Eve.defer(this.evt)},observe:function(){Eve.observe(this.evt)}}},remove:function(r,n){if(e[r])for(var t=0;t<e[r].length;t++)if(e[r][t].fn===n||e[r][t].fn.toString()===n.toString()){e[r].splice(t,1);break}},removeAll:function(n){delete e[n],r[n]=r[n]||{},delete r[n]}},t={checkInactive:function(e){r[e]&&(r[e].ignore&&delete r[e].ignore,r[e].defer&&(delete r[e].defer,Eve.emit(e)))},checkTriggers:function(e){function n(e){for(;e.length;){var r=e.shift();t.checkInactive(r)}e=null}r[e]&&(r[e].ignoreTrigger&&n(r[e].ignoreTrigger),r[e].deferTrigger&&n(r[e].deferTrigger))},emit:function(){function n(){if(e[g])for(var r=0,n=e[g].length;n>r;r++)e[g][r].fn.apply(null,i)}for(var i=[],o=0,f=arguments.length;f>o;o++)i[o]=arguments[o];var g=i.shift();r[g]=r[g]||{},r[g].ignore||r[g].defer||(e[g]&&n(),t.checkTriggers(g))},ignore:function(e){r[e]=r[e]||{},r[e].ignore=!0;var n=e;return{getEvt:function(){return n},until:function(e){r[e]=r[e]||{},r[e].ignoreTrigger=r[e].ignoreTrigger||[],r[e].ignoreTrigger.push(this.getEvt())}}},defer:function(e){r[e]=r[e]||{},r[e].defer=!0;var n=e;return{getEvt:function(){return n},until:function(e){r[e]=r[e]||{},r[e].deferTrigger=r[e].deferTrigger||[],r[e].deferTrigger.push(this.getEvt())}}},observe:function(e){r[e]=r[e]||{},delete r[e].ignore,delete r[e].defer}};return{on:n.add,remove:n.remove,removeAll:n.removeAll,emit:t.emit,ignore:t.ignore,observe:t.observe,defer:t.defer}}();